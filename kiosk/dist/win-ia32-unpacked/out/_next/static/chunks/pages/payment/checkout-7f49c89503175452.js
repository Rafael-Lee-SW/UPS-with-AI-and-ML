(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[283],{5323:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/payment/checkout",function(){return n(940)}])},940:function(e,t,n){"use strict";n.r(t),n.d(t,{CheckoutPage:function(){return E},default:function(){return b}});var r=n(5893),o=n(1163);function c(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function l(e,t,n){return(l=s()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&a(o,n.prototype),o}).apply(null,arguments)}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return l(e,arguments,i(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,e)})(e)}function d(e){var t=s();return function(){var n,r=i(e);return n=t?Reflect.construct(r,arguments,i(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}var p=null;function h(e){return window[e]}var y=function(e){u(n,e);var t=d(n);function n(e){var r;return c(this,n),(r=t.call(this,"[TossPayments SDK] ".concat(e," is not available"))).name="NamespaceNotAvailableError",r}return n}(f(Error)),m=function(e){u(n,e);var t=d(n);function n(e){var r;return c(this,n),(r=t.call(this,"[TossPayments SDK] Failed to load script: [".concat(e,"]"))).name="ScriptLoadFailedError",r}return n}(f(Error)),v=n(7294),w=n(9755),_=n.n(w);function E(){let e=(0,o.useRouter)(),[t,n]=(0,v.useState)([]),[c,u]=(0,v.useState)(0),[i,a]=(0,v.useState)(!1),[s,l]=(0,v.useState)(null);return(0,v.useEffect)(()=>{if(e.query.scanedProducts&&e.query.totalPrice){let t=decodeURIComponent(e.query.scanedProducts),r=e.query.totalPrice;console.log("Scanned Products (decoded): ",t),console.log("Total Price: ",r),n(JSON.parse(t)),u(Number(r))}},[e.query]),(0,v.useEffect)(()=>{(async function(){l((await function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.src;return"undefined"==typeof window?Promise.resolve({}):(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return null!=p?p:p=new Promise(function(r,o){try{var c,u=function(){null!=h(t)?r(h(t)):o(new y(t))},i=function(){o(new m(e))};if("undefined"==typeof window||"undefined"==typeof document)return r(null);if(null!=h(t))return r(h(t));var a=document.querySelector('script[src="'.concat(e,'"]'));null!=a&&(a.removeEventListener("load",u),a.removeEventListener("error",i),null===(c=a.parentElement)||void 0===c||c.removeChild(a));var s=document.createElement("script");s.src=e,s.addEventListener("load",u),s.addEventListener("error",i),null!=n.priority&&(s.fetchPriority=n.priority),document.head.appendChild(s)}catch(e){o(e);return}}).catch(function(e){return p=null,Promise.reject(e)})})(void 0===n?"https://js.tosspayments.com/v2/standard":n,"TossPayments").then(function(t){return t(e)})}("test_gck_docs_Ovk5rk1EwkEbP0W43n07xlzm")).widgets({customerKey:"EeNPZPYSwnohr7iITJk9n"}))})()},[]),(0,v.useEffect)(()=>{(async function(){null!=s&&(await s.setAmount({currency:"KRW",value:c}),await Promise.all([s.renderPaymentMethods({selector:"#payment-method",variantKey:"DEFAULT"}),s.renderAgreement({selector:"#agreement",variantKey:"AGREEMENT"})]),a(!0))})()},[s,c]),(0,r.jsx)("div",{className:"wrapper",children:(0,r.jsxs)("div",{className:"box_section",children:[(0,r.jsx)("h2",{children:"결제 방식을 선택해 주세요"}),(0,r.jsx)("h3",{children:"상품 목록"}),(0,r.jsx)("ul",{children:t.map(e=>(0,r.jsxs)("li",{children:[e.productName," - ",e.quantity,"개 -"," ",e.sellingPrice,"원"]},e.productId))}),(0,r.jsxs)("h3",{children:["총 가격: ",c,"원"]}),(0,r.jsx)("div",{id:"payment-method"}),(0,r.jsx)("div",{id:"agreement"}),(0,r.jsxs)("div",{className:_().checkoutFooter,children:[(0,r.jsx)("button",{className:_().cancelBtn,onClick:()=>e.push("/select"),children:"주문 취소"}),(0,r.jsx)("button",{className:_().checkoutBtn,disabled:!i,onClick:async()=>{try{console.log("Requesting payment...");let e=encodeURIComponent(JSON.stringify(t));await s.requestPayment({orderId:Math.random().toString(36).slice(2),orderName:"총 결제 상품",successUrl:"".concat(window.location.origin,"/payment/success?products=").concat(e,"&totalPrice=").concat(c),failUrl:window.location.origin+"/payment/fail",customerEmail:"customer@example.com",customerName:"고객명",customerMobilePhone:"01012345678"})}catch(e){console.error("결제 중 오류 발생:",e)}},children:"결제하기"})]})]})})}var b=E},9755:function(e){e.exports={cancelBtn:"checkout_cancelBtn__s5DJU",checkoutBtn:"checkout_checkoutBtn__3cy7I",checkoutFooter:"checkout_checkoutFooter__M134b"}},1163:function(e,t,n){e.exports=n(9090)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5323)}),_N_E=e.O()}]);